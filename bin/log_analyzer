#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)
require 'log_analyzer'

unless ARGV.length <= 1 && ARGV.map { |f| File.exist?(f) }.all?
  STDOUT.write <<~EOS
  Usage:

  This is a utility to output a list of the 100 most common #{LogAnalyzer::Analyzer::SEQUENCE_SIZE}-word
  sequences in one or more texts.

  $ bin/log_analyzer file.txt
  $ cat file | bin/log_analyzer
  $ bin/log_analyzer # will wait for input on STDIN; input is terminated with ^D.

  EOS

  exit(1)
end

input = ARGV.any? ? ARGV : STDIN
result = LogAnalyzer::Analyzer.new(input).run
